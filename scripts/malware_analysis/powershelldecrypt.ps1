function Enc_Dec-File($key, $File) {

    [byte[]]$key = $key

    $Suffix = "`.wannacookie"
        [System.Reflection.Assembly]::LoadWithPartialName('System.Security.Cryptography')
        [System.Int32]$KeySize = $key.Length*8

    $AESP = New-Object 'System.Security.Cryptography.AesManaged'
    $AESP.Mode = [System.Security.Cryptography.CipherMode]::CBC
    $AESP.BlockSize = 128
    $AESP.KeySize = $KeySize
    $AESP.Key = $key
    $FileSR = New-Object System.IO.FileStream($File, [System.IO.FileMode]::Open)
    $DestFile = ($File -replace $Suffix)
    $FileSW = New-Object System.IO.FileStream($DestFile, [System.IO.FileMode]::Create)

    [Byte[]]$LenIV = New-Object Byte[] 4
    $FileSR.Seek(0, [System.IO.SeekOrigin]::Begin) | Out-Null
    $FileSR.Read($LenIV,  0, 3) | Out-Null
        [Int]$LIV = [System.BitConverter]::ToInt32($LenIV,  0)
        [Byte[]]$IV = New-Object Byte[] $LIV
    $FileSR.Seek(4, [System.IO.SeekOrigin]::Begin) | Out-Null
    $FileSR.Read($IV, 0, $LIV) | Out-Null
    $AESP.IV = $IV
    $Transform = $AESP.CreateDecryptor()


    $CryptoS = New-Object System.Security.Cryptography.CryptoStream($FileSW, $Transform, [System.Security.Cryptography.CryptoStreamMode]::Write)
    [Int]$Count = 0
        [Int]$BlockSzBts = $AESP.BlockSize / 8
        [Byte[]]$Data = New-Object Byte[] $BlockSzBts
    Do
    {
        $Count = $FileSR.Read($Data, 0, $BlockSzBts)
        $CryptoS.Write($Data, 0, $Count)
    }
    While ($Count -gt 0)
    $CryptoS.FlushFinalBlock()
    $CryptoS.Close()
    $FileSR.Close()
    $FileSW.Close()
    Clear-variable -Name "key"
    # Remove-Item $File
}




$Byte_key = ([System.Text.Encoding]::Unicode.GetBytes($(([char[]]([char]01..[char]255) + ([char[]]([char]01..[char]255)) + 0..9 | sort {Get-Random})[0..15] -join ''))  | ? {$_ -ne 0x00})

$Byte_key[0] = 251
$Byte_key[1] = 207
$Byte_key[2] = 193
$Byte_key[3] = 33
$Byte_key[4] = 145
$Byte_key[5] = 93
$Byte_key[6] = 153
$Byte_key[7] = 204
$Byte_key[8] = 32
$Byte_key[9] = 163
$Byte_key[10] = 211
$Byte_key[11] = 213
$Byte_key[12] = 216
$Byte_key[13] = 79
$Byte_key[14] = 131
$Byte_key[15] = 8
Enc_Dec-File $Byte_key "z:\alabaster_passwords.elfdb.wannacookie"
